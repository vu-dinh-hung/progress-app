(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{73:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(15),c=n.n(a),s=(n(71),n(30)),o=n(7),i=n.n(o),u=n(10),l=n(14),d=n(64),b=n(107),j=n(112),p=n(108),h=(n(73),n(103)),f=n(104),m=n(105),O=n(102),x=n(28),g=n(29),v=n(60),w=n(61),y=n(66),k=n(65),C=n(111),S=n(62),I=n(2),N=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(w.a)(n,[{key:"handleClickOutside",value:function(){console.log("clicked outside"),this.props.handleCancelShowHabitForm()}},{key:"render",value:function(){var e=this.props,t=e.newHabit,n=e.setNewHabit,r=e.handleSubmitHabit;return Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{className:"align-middle text-center",children:Object(I.jsxs)(C.a,{onSubmit:r,children:[Object(I.jsx)(C.a.Group,{controlId:"formHabit",children:Object(I.jsx)(C.a.Control,{as:"input",type:"text",placeholder:"",autoComplete:"off",value:t,onChange:function(e){var t=e.target;return n(t.value)}})}),Object(I.jsx)(O.a,{variant:"secondary",type:"submit",children:"Submit"})]})}),Object(I.jsx)("td",{colSpan:"30",className:"align-middle text-secondary",children:"Type a new habit or click away to cancel"})]})}}]),n}(r.Component),D=Object(S.a)(N),H=function(e){var t=e.today,n=e.month,r=e.habits,a=e.logs,c=e.handleToggleCell,o=e.handleClickShowHabitForm,i=e.handleCancelShowHabitForm,u=e.handleSubmitHabit,l=e.newHabit,d=e.setNewHabit,b=e.showHabitForm,j=Object(h.a)(n);console.log("[Tracker] logs:",a);var p=a.reduce((function(e,t){return e.set(t.habitId,[].concat(Object(s.a)(e.get(t.habitId)||[]),[new Date(t.date).getDate()]))}),new Map);return Object(I.jsxs)(f.a,{fluid:!0,children:[Object(I.jsxs)(m.a,{bordered:!0,responsive:!0,style:{borderStyle:"hidden"},children:[Object(I.jsx)("thead",{children:Object(I.jsxs)("tr",{children:[Object(I.jsx)("th",{}),Object(s.a)(Array(31)).map((function(e,r){return r<j?Object(I.jsx)("th",{className:r+1===t.getDate()&&n.getMonth()===t.getMonth()?"text-center border-dark border-right-0":"text-center",children:r+1}):Object(I.jsx)("th",{className:"text-center text-light",children:r+1})}))]})}),Object(I.jsxs)("tbody",{children:[r.map((function(e){return Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{className:"align-middle",children:e.name}),Object(s.a)(Array(31)).map((function(t,n){return Object(I.jsx)("td",{className:"align-middle text-center",style:{padding:0,width:"3%"},children:n<j&&Object(I.jsx)(O.a,{variant:"outline-dark",size:"sm",onClick:function(){return c(n+1,e.id,p.get(e.id)&&p.get(e.id).includes(n+1))},children:Object(I.jsx)(x.a,{icon:g.a,className:p.get(e.id)&&p.get(e.id).includes(n+1)?"":"text-light"})})})}))]})})),b&&Object(I.jsx)(D,{handleCancelShowHabitForm:i,handleSubmitHabit:u,newHabit:l,setNewHabit:d})]})]}),Object(I.jsx)(O.a,{variant:"outline-secondary",size:"sm",block:!0,onClick:o,children:Object(I.jsx)(x.a,{icon:g.d})})]})},U=n(110),M=n(113),L=n(106),T=n(114),F=n(109),G=function(e){var t=e.username,n=e.setUsername,r=e.password,a=e.setPassword,c=e.handleLogin,s=Object(I.jsxs)(T.a,{id:"login-card",children:[Object(I.jsx)(T.a.Title,{as:"h3",children:"Login"}),Object(I.jsx)(T.a.Content,{children:Object(I.jsxs)(C.a,{onSubmit:c,children:[Object(I.jsxs)(C.a.Group,{controlId:"formGroupUsername",children:[Object(I.jsx)(C.a.Label,{children:"Username"}),Object(I.jsx)(C.a.Control,{type:"username",placeholder:"Enter username",value:t,autoComplete:"off",onChange:function(e){var t=e.target;return n(t.value)}})]}),Object(I.jsxs)(C.a.Group,{controlId:"formGroupPassword",children:[Object(I.jsx)(C.a.Label,{children:"Password"}),Object(I.jsx)(C.a.Control,{type:"password",placeholder:"Password",value:r,autoComplete:"off",onChange:function(e){var t=e.target;return a(t.value)}})]}),Object(I.jsx)(O.a,{variant:"primary",type:"submit",children:"Submit"})]})})]});return Object(I.jsx)(F.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:s,children:Object(I.jsx)(O.a,{variant:"outline-primary",children:"Login"})})},B=n(31),P=n.n(B),z={login:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},E=function(e){var t=e.setUser,n=Object(r.useState)(""),a=Object(l.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(""),d=Object(l.a)(o,2),b=d[0],j=d[1],p=Object(r.useState)(""),h=Object(l.a)(p,2),f=h[0],m=h[1],x=function(){var e=Object(u.a)(i.a.mark((function e(n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,z.register({username:c,password:b,name:f});case 4:r=e.sent,window.localStorage.setItem("progressUser",JSON.stringify(r)),t(r),s(""),j(""),m(""),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0);case 15:s(""),j(""),window.location.reload(!1);case 18:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),g=Object(I.jsxs)(T.a,{id:"register-card",children:[Object(I.jsx)(T.a.Title,{as:"h3",children:"Register"}),Object(I.jsx)(T.a.Content,{children:Object(I.jsxs)(C.a,{onSubmit:x,children:[Object(I.jsxs)(C.a.Group,{controlId:"formGroupUsername",children:[Object(I.jsx)(C.a.Label,{children:"Username"}),Object(I.jsx)(C.a.Control,{type:"username",placeholder:"Enter username",value:c,autoComplete:"off",onChange:function(e){var t=e.target;return s(t.value)}})]}),Object(I.jsxs)(C.a.Group,{controlId:"formGroupPassword",children:[Object(I.jsx)(C.a.Label,{children:"Password"}),Object(I.jsx)(C.a.Control,{type:"password",placeholder:"Password",value:b,autoComplete:"off",onChange:function(e){var t=e.target;return j(t.value)}})]}),Object(I.jsxs)(C.a.Group,{controlId:"formGroupName",children:[Object(I.jsx)(C.a.Label,{children:"Name"}),Object(I.jsx)(C.a.Control,{type:"text",placeholder:"Your name",value:f,autoComplete:"off",onChange:function(e){var t=e.target;return m(t.value)}})]}),Object(I.jsx)(O.a,{variant:"primary",type:"submit",children:"Submit"})]})})]});return Object(I.jsx)(F.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:g,children:Object(I.jsx)(O.a,{variant:"outline-primary",children:"Register"})})},J=function(e){var t=e.user,n=e.handleLogout,r=Object(I.jsxs)(T.a,{id:"user-card",children:[Object(I.jsxs)(T.a.Title,{as:"h3",children:["Logged in as ",t.username]}),Object(I.jsx)(T.a.Content,{className:"text-center",children:Object(I.jsx)(O.a,{variant:"primary",onClick:n,children:"Logout"})})]});return Object(I.jsx)(F.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:r,children:Object(I.jsx)(O.a,{variant:"outline-primary",children:t.name?t.name:t.username})})},Y=function(e){var t=e.month,n=e.onIncrementMonth,r=e.onDecrementMonth,a=e.username,c=e.password,s=e.user,o=e.setUser,i=e.setUsername,u=e.setPassword,l=e.handleLogin,d=e.handleLogout;return Object(I.jsx)(M.a,{bg:"light",children:Object(I.jsxs)(f.a,{children:[Object(I.jsxs)(L.a,{className:"mb-1 mx-2","aria-label":"navigate month",children:[Object(I.jsx)(O.a,{onClick:r,variant:"outline-dark",size:"sm",children:Object(I.jsx)(x.a,{className:"mt-1",icon:g.b})}),Object(I.jsx)(O.a,{onClick:n,variant:"outline-dark",size:"sm",children:Object(I.jsx)(x.a,{className:"mt-1",icon:g.c})})]}),Object(I.jsx)("span",{className:"mr-auto",children:Object(U.a)(t,"MMMM yyyy")}),s?Object(I.jsx)(J,{user:s,handleLogout:d}):Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(E,{setUser:o}),Object(I.jsx)("span",{className:"mx-1"}),Object(I.jsx)(G,{username:a,password:c,setUsername:i,setPassword:u,handleLogin:l})]})]})})},A=n(31),K="/api/logs",R=null,q=null,Q={setToken:function(e){R="bearer ".concat(e),q={headers:{Authorization:R}}},get:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get(K,q);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getByMonth:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get("/api/logs?yearmonth=".concat(""+t.getFullYear()+t.getMonth()),q);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getById:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.get("".concat(K,"/").concat(t),q);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),post:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.post(K,t,q);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),putById:function(){var e=Object(u.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.put("".concat(K,"/").concat(t),n,q);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteById:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.delete("".concat(K,"/").concat(t),q);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},V=n(31),W="/api/habits",X=null,Z=null,$={setToken:function(e){X="bearer ".concat(e),Z={headers:{Authorization:X}}},get:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get(W,Z);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getById:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.get("".concat(W,"/").concat(t),Z);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),post:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.post(W,t,Z);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),putById:function(){var e=Object(u.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.put("".concat(W,"/").concat(t),n,Z);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteById:function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.delete("".concat(W,"/").concat(t),Z);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},_=function(){var e=new Date,t=Object(r.useState)(new Date(Date.UTC(e.getFullYear(),e.getMonth()))),n=Object(l.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)([]),h=Object(l.a)(o,2),f=h[0],m=h[1],O=Object(r.useState)([]),x=Object(l.a)(O,2),g=x[0],v=x[1],w=Object(r.useState)(""),y=Object(l.a)(w,2),k=y[0],C=y[1],S=Object(r.useState)(""),N=Object(l.a)(S,2),D=N[0],U=N[1],M=Object(r.useState)(null),L=Object(l.a)(M,2),T=L[0],F=L[1],G=Object(r.useState)(!1),B=Object(l.a)(G,2),P=B[0],E=B[1],J=Object(r.useState)(""),A=Object(l.a)(J,2),K=A[0],R=A[1];Object(r.useEffect)((function(){var e=window.localStorage.getItem("progressUser");if(e){var t=JSON.parse(e);F(t),console.log("--first",t),Q.setToken(t.token),$.setToken(t.token)}}),[]),Object(r.useEffect)((function(){$.get().then((function(e){m(e)}))}),[]),Object(r.useEffect)((function(){Q.getByMonth(a).then((function(e){console.log(e),v(e)}))}),[a]);var q=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,z.login({username:k,password:D});case 4:n=e.sent,window.localStorage.setItem("progressUser",JSON.stringify(n)),F(n),C(""),U(""),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:C(""),U(""),window.location.reload(!1);case 17:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),window.localStorage.removeItem("progressUser"),F(null),window.location.reload(!1);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,z.register({username:k,password:D});case 4:n=e.sent,window.localStorage.setItem("progressUser",JSON.stringify(n)),F(n),C(""),U(""),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:C(""),U(""),window.location.reload(!1);case 17:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(u.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={id:f.length+1,name:K},e.next=4,$.post(n);case 4:r=e.sent,m(f.concat(r)),R(""),E(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(u.a)(i.a.mark((function e(t,n,r){var c,o,u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("----------------clicked cell",n,t),c=Object(s.a)(g),!r){e.next=9;break}return o=g.find((function(e){return e.habitId===n&&new Date(e.date).getDate()===t})).id,e.next=6,Q.deleteById(o);case 6:c=c.filter((function(e){return!(e.habitId===n&&new Date(e.date).getDate()===t)})),e.next=14;break;case 9:return u={habitId:n,date:new Date(Date.UTC(a.getFullYear(),a.getMonth(),t))},e.next=12,Q.post(u);case 12:l=e.sent,c.push(l);case 14:v(c);case 15:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return Object(I.jsxs)("div",{children:[Object(I.jsx)(Y,{month:a,onIncrementMonth:function(){return c(Object(d.a)(new Date(Date.UTC(a.getFullYear(),a.getMonth())),1))},onDecrementMonth:function(){return c(Object(b.a)(new Date(Date.UTC(a.getFullYear(),a.getMonth())),1))},username:k,password:D,user:T,setUser:F,setUsername:C,setPassword:U,handleLogin:q,handleLogout:V,handleRegister:W}),Object(I.jsxs)(j.a,{defaultActiveKey:"tracker",id:"tabs",children:[Object(I.jsx)(p.a,{eventKey:"tracker",title:"Tracker",className:"",children:Object(I.jsx)(H,{today:e,month:a,habits:f,logs:g,handleToggleCell:Z,handleClickShowHabitForm:function(){return E(!0)},handleCancelShowHabitForm:function(){R(""),E(!1)},handleSubmitHabit:X,newHabit:K,setNewHabit:R,showHabitForm:P})}),Object(I.jsxs)(p.a,{eventKey:"stats",title:"Stats",children:[Object(I.jsx)("br",{}),Object(I.jsx)("br",{}),Object(I.jsx)("p",{className:"text-center",children:"Coming soon~"})]})]})]})};c.a.render(Object(I.jsx)(_,{}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.78fdc4cc.chunk.js.map