(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{108:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(15),c=n.n(a),s=(n(82),n(7)),o=n.n(s),i=n(10),u=n(14),l=n(75),d=n(119),b=n(125),j=n(120),h=(n(84),n(57)),p=n(114),f=n(115),O=n(116),x=n(113),m=n(33),g=n(34),v=n(72),w=n(73),y=n(77),k=n(76),C=n(124),D=n(74),S=n(2),I=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(w.a)(n,[{key:"handleClickOutside",value:function(){console.log("clicked outside"),this.props.handleCancelShowHabitForm()}},{key:"render",value:function(){var e=this.props,t=e.newHabit,n=e.setNewHabit,r=e.handleSubmitHabit;return Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{className:"align-middle text-center",children:Object(S.jsxs)(C.a,{onSubmit:r,children:[Object(S.jsx)(C.a.Group,{controlId:"formHabit",children:Object(S.jsx)(C.a.Control,{as:"input",type:"text",placeholder:"",autoComplete:"off",value:t,onChange:function(e){var t=e.target;return n(t.value)}})}),Object(S.jsx)(x.a,{variant:"secondary",type:"submit",children:"Submit"})]})}),Object(S.jsx)("td",{colSpan:"30",className:"align-middle text-secondary",children:"Type a new habit or click away to cancel"})]})}}]),n}(r.Component),H=Object(D.a)(I),T=function(e){var t=e.month,n=e.habits,r=e.logs,a=e.handleToggleCell,c=e.handleClickShowHabitForm,s=e.handleCancelShowHabitForm,o=e.handleSubmitHabit,i=e.newHabit,u=e.setNewHabit,l=e.showHabitForm,d=e.setHabitIdToDelete,b=Object(p.a)(t);console.log("[Tracker] logs:",r);var j=r.reduce((function(e,t){return e.set(t.habitId,[].concat(Object(h.a)(e.get(t.habitId)||[]),[new Date(t.date).getDate()]))}),new Map);return Object(S.jsxs)(f.a,{fluid:!0,children:[Object(S.jsxs)(O.a,{bordered:!0,responsive:!0,style:{borderStyle:"hidden"},children:[Object(S.jsx)("thead",{children:Object(S.jsxs)("tr",{children:[Object(S.jsx)("th",{}),Object(h.a)(Array(31)).map((function(e,n){return n<b?Object(S.jsx)("th",{className:n+1===(new Date).getDate()&&t.getMonth()===(new Date).getMonth()?"text-center border-dark border-right-0":"text-center",children:n+1}):Object(S.jsx)("th",{className:"text-center text-light",children:n+1})}))]})}),Object(S.jsxs)("tbody",{children:[n.map((function(e){return Object(S.jsxs)("tr",{children:[Object(S.jsxs)("td",{children:[Object(S.jsx)(x.a,{variant:"sm",onClick:function(){return d(e.id)},children:Object(S.jsx)(m.a,{icon:g.e})}),e.name]}),Object(h.a)(Array(31)).map((function(t,n){return Object(S.jsx)("td",{className:"align-middle text-center",style:{padding:0,width:"3%"},children:n<b&&Object(S.jsx)(x.a,{variant:"outline-dark",size:"sm",onClick:function(){return a(n+1,e.id,j.get(e.id)&&j.get(e.id).includes(n+1))},children:Object(S.jsx)(m.a,{icon:g.a,className:j.get(e.id)&&j.get(e.id).includes(n+1)?"":"text-light"})})})}))]})})),l&&Object(S.jsx)(H,{handleCancelShowHabitForm:s,handleSubmitHabit:o,newHabit:i,setNewHabit:u})]})]}),Object(S.jsx)(x.a,{variant:"outline-secondary",size:"sm",block:!0,onClick:c,children:Object(S.jsx)(m.a,{icon:g.d})})]})},N=n(122),M=n(126),U=n(117),L=n(127),F=n(121),B=function(e){var t=e.username,n=e.setUsername,r=e.password,a=e.setPassword,c=e.handleLogin,s=Object(S.jsxs)(L.a,{id:"login-card",children:[Object(S.jsx)(L.a.Title,{as:"h3",children:"Login"}),Object(S.jsx)(L.a.Content,{children:Object(S.jsxs)(C.a,{onSubmit:c,children:[Object(S.jsxs)(C.a.Group,{controlId:"formGroupUsername",children:[Object(S.jsx)(C.a.Label,{children:"Username"}),Object(S.jsx)(C.a.Control,{type:"username",placeholder:"Enter username",value:t,autoComplete:"off",onChange:function(e){var t=e.target;return n(t.value)}})]}),Object(S.jsxs)(C.a.Group,{controlId:"formGroupPassword",children:[Object(S.jsx)(C.a.Label,{children:"Password"}),Object(S.jsx)(C.a.Control,{type:"password",placeholder:"Password",value:r,autoComplete:"off",onChange:function(e){var t=e.target;return a(t.value)}})]}),Object(S.jsx)(x.a,{variant:"primary",type:"submit",children:"Submit"})]})})]});return Object(S.jsx)(F.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:s,children:Object(S.jsx)(x.a,{variant:"outline-primary",children:"Login"})})},G=n(39),E=n.n(G),P={login:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Y=function(e){var t=e.setUser,n=e.displayMessage,a=Object(r.useState)(""),c=Object(u.a)(a,2),s=c[0],l=c[1],d=Object(r.useState)(""),b=Object(u.a)(d,2),j=b[0],h=b[1],p=Object(r.useState)(""),f=Object(u.a)(p,2),O=f[0],m=f[1],g=function(){var e=Object(i.a)(o.a.mark((function e(r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,P.register({username:s,password:j});case 4:a=e.sent,window.localStorage.setItem("progressUser",JSON.stringify(a)),t(a),n("User registered. Logged in as "+a.username),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),e.t0.response.data.error?n("Error: "+e.t0.response.data.error):n(""+e.t0);case 13:l(""),h("");case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){return Object(S.jsx)("span",{style:{color:"red"},children:"*"})},w=Object(S.jsxs)(L.a,{id:"register-card",children:[Object(S.jsx)(L.a.Title,{as:"h3",children:"Register"}),Object(S.jsx)(L.a.Content,{children:Object(S.jsxs)(C.a,{onSubmit:g,children:[Object(S.jsxs)(C.a.Group,{controlId:"formGroupUsername",children:[Object(S.jsxs)(C.a.Label,{children:["Username",v()]}),Object(S.jsx)(C.a.Control,{type:"username",placeholder:"Enter username",value:s,autoComplete:"off",onChange:function(e){var t=e.target;return l(t.value)},required:!0})]}),Object(S.jsxs)(C.a.Group,{controlId:"formGroupPassword",children:[Object(S.jsxs)(C.a.Label,{children:["Password",v()]}),Object(S.jsx)(C.a.Control,{type:"password",placeholder:"Password",value:j,autoComplete:"off",onChange:function(e){var t=e.target;return h(t.value)},required:!0})]}),Object(S.jsxs)(C.a.Group,{controlId:"formGroupName",children:[Object(S.jsx)(C.a.Label,{children:"Name"}),Object(S.jsx)(C.a.Control,{type:"text",placeholder:"Your name",value:O,autoComplete:"off",onChange:function(e){var t=e.target;return m(t.value)}})]}),Object(S.jsx)(x.a,{variant:"primary",type:"submit",children:"Submit"})]})})]});return Object(S.jsx)(F.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:w,children:Object(S.jsx)(x.a,{variant:"outline-primary",children:"Register"})})},z=function(e){var t=e.user,n=e.handleLogout,r=Object(S.jsxs)(L.a,{id:"user-card",children:[Object(S.jsxs)(L.a.Title,{as:"h3",children:["Logged in as ",t.username]}),Object(S.jsx)(L.a.Content,{className:"text-center",children:Object(S.jsx)(x.a,{variant:"primary",onClick:n,children:"Logout"})})]});return Object(S.jsx)(F.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:r,children:Object(S.jsx)(x.a,{variant:"outline-primary",children:t.name?t.name:t.username})})},A=function(e){var t=e.month,n=e.onIncrementMonth,r=e.onDecrementMonth,a=e.username,c=e.password,s=e.user,o=e.setUser,i=e.setUsername,u=e.setPassword,l=e.handleLogin,d=e.handleLogout,b=e.displayMessage;return Object(S.jsx)(M.a,{bg:"light",children:Object(S.jsxs)(f.a,{children:[Object(S.jsxs)(U.a,{className:"mb-1 mx-2","aria-label":"navigate month",children:[Object(S.jsx)(x.a,{onClick:r,variant:"outline-dark",size:"sm",children:Object(S.jsx)(m.a,{className:"mt-1",icon:g.b})}),Object(S.jsx)(x.a,{onClick:n,variant:"outline-dark",size:"sm",children:Object(S.jsx)(m.a,{className:"mt-1",icon:g.c})})]}),Object(S.jsx)("span",{className:"mr-auto",children:Object(N.a)(t,"MMMM yyyy")}),s?Object(S.jsx)(z,{user:s,handleLogout:d}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(Y,{setUser:o,displayMessage:b}),Object(S.jsx)("span",{className:"mx-1"}),Object(S.jsx)(B,{username:a,password:c,setUsername:i,setPassword:u,handleLogin:l})]})]})})},J=n(118),K=function(e){var t=e.message;return Object(S.jsx)(J.a,{variant:t.startsWith("Error")?"danger":"info",children:t})},q=n(123),R=function(e){var t=e.habits,n=e.habitIdToDelete,r=e.handleDeleteHabit,a=e.handleCancelDeleteHabit;return Object(S.jsxs)(q.a,{show:null!==n,onHide:a,children:[Object(S.jsx)(q.a.Header,{closeButton:!0,children:Object(S.jsxs)(q.a.Title,{children:['Delete habit "',n&&t.find((function(e){return e.id===n}))&&t.find((function(e){return e.id===n})).name,'"?']})}),Object(S.jsx)(q.a.Body,{children:"You will lose all tracking data related to this habit."}),Object(S.jsxs)(q.a.Footer,{className:"d-flex",children:[Object(S.jsx)(x.a,{variant:"secondary",onClick:a,className:"mr-auto",children:"Cancel"}),Object(S.jsx)(x.a,{variant:"danger",onClick:function(){return r(n)},children:"Delete"})]})]})},W=n(39),Q="/api/logs",V=null,X=null,Z={setToken:function(e){V="bearer ".concat(e),X={headers:{Authorization:V}}},get:function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.get(Q,X);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getByMonth:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.get("/api/logs?yearmonth=".concat(""+t.getFullYear()+t.getMonth()),X);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getById:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.get("".concat(Q,"/").concat(t),X);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),post:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.post(Q,t,X);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),putById:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.put("".concat(Q,"/").concat(t),n,X);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteById:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.delete("".concat(Q,"/").concat(t),X);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},$=n(39),_="/api/habits",ee=null,te=null,ne={setToken:function(e){ee="bearer ".concat(e),te={headers:{Authorization:ee}}},get:function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get(_,te);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getById:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.get("".concat(_,"/").concat(t),te);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),post:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.post(_,t,te);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),putById:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.put("".concat(_,"/").concat(t),n,te);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteById:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$.delete("".concat(_,"/").concat(t),te);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},re=function(){var e=Object(r.useState)(new Date(Date.UTC((new Date).getFullYear(),(new Date).getMonth()))),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),s=Object(u.a)(c,2),h=s[0],p=s[1],f=Object(r.useState)([]),O=Object(u.a)(f,2),x=O[0],m=O[1],g=Object(r.useState)(""),v=Object(u.a)(g,2),w=v[0],y=v[1],k=Object(r.useState)(""),C=Object(u.a)(k,2),D=C[0],I=C[1],H=Object(r.useState)(null),N=Object(u.a)(H,2),M=N[0],U=N[1],L=Object(r.useState)(!1),F=Object(u.a)(L,2),B=F[0],G=F[1],E=Object(r.useState)(""),Y=Object(u.a)(E,2),z=Y[0],J=Y[1],q=Object(r.useState)(""),W=Object(u.a)(q,2),Q=W[0],V=W[1],X=Object(r.useState)(null),$=Object(u.a)(X,2),_=$[0],ee=$[1],te="You are in guest mode. Any change will be lost upon reloading. To start using the app, please register.";Object(r.useEffect)((function(){var e=window.localStorage.getItem("progressUser");if(e){var t=JSON.parse(e);U(t),console.log("--first",t),Z.setToken(t.token),ne.setToken(t.token)}}),[]),Object(r.useEffect)((function(){Z.getByMonth(n).then((function(e){m(e)}))}),[n]),Object(r.useEffect)((function(){M?(Q===te&&V(""),Z.setToken(M.token),ne.setToken(M.token),ne.get().then((function(e){p(e)})),a(new Date(Date.UTC((new Date).getFullYear(),(new Date).getMonth())))):(Q||V(te),p([]),m([]))}),[M]),Object(r.useEffect)((function(){h.length>0?G(!1):G(!0)}),[h]);var re=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;V(e),setTimeout((function(){return V("")}),t)},ae=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,P.login({username:w,password:D});case 4:n=e.sent,window.localStorage.setItem("progressUser",JSON.stringify(n)),U(n),re("Logged in as "+n.username),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),re("Error: Wrong credentials. If you don't have an account yet, please register");case 14:y(""),I("");case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),window.localStorage.removeItem("progressUser"),U(null),re("Logged out");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n={id:h.length+1,name:z},J(""),G(!1),!M){e.next=8;break}return e.next=7,ne.post(n);case 7:n=e.sent;case 8:p(h.concat(n));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=Object(i.a)(o.a.mark((function e(t,r,a){var c,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("----------------clicked cell",r,t),!a){e.next=9;break}if(c=x.find((function(e){return e.habitId===r&&new Date(e.date).getDate()===t})).id,m(x.filter((function(e){return!(e.habitId===r&&new Date(e.date).getDate()===t)}))),!M){e.next=7;break}return e.next=7,Z.deleteById(c);case 7:e.next=15;break;case 9:if(s={habitId:r,date:new Date(Date.UTC(n.getFullYear(),n.getMonth(),t))},!M){e.next=14;break}return e.next=13,Z.post(s);case 13:s=e.sent;case 14:m(x.concat(s));case 15:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),ie=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("removing",t),ee(null),p(h.filter((function(e){return!(e.id===t)}))),!M){e.next=6;break}return e.next=6,ne.deleteById(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsxs)("div",{children:[Object(S.jsx)(A,{month:n,onIncrementMonth:function(){return a(Object(l.a)(new Date(Date.UTC(n.getFullYear(),n.getMonth())),1))},onDecrementMonth:function(){return a(Object(d.a)(new Date(Date.UTC(n.getFullYear(),n.getMonth())),1))},username:w,password:D,user:M,setUser:U,setUsername:y,setPassword:I,handleLogin:ae,handleLogout:ce,displayMessage:re}),Q&&Object(S.jsx)(K,{message:Q}),Object(S.jsx)(R,{habits:h,habitIdToDelete:_,handleDeleteHabit:ie,handleCancelDeleteHabit:function(){console.log("cancelling delete habit"),ee(null)}}),Object(S.jsxs)(b.a,{defaultActiveKey:"tracker",id:"tabs",children:[Object(S.jsx)(j.a,{eventKey:"tracker",title:"Tracker",className:"",children:Object(S.jsx)(T,{month:n,habits:h,logs:x,handleToggleCell:oe,handleClickShowHabitForm:function(){return G(!0)},handleCancelShowHabitForm:function(){J(""),G(!1)},handleSubmitHabit:se,newHabit:z,setNewHabit:J,showHabitForm:B,setHabitIdToDelete:ee})}),Object(S.jsxs)(j.a,{eventKey:"stats",title:"Stats",children:[Object(S.jsx)("br",{}),Object(S.jsx)("br",{}),Object(S.jsx)("p",{className:"text-center",children:"Coming soon~"})]})]})]})};c.a.render(Object(S.jsx)(re,{}),document.getElementById("root"))},84:function(e,t,n){}},[[108,1,2]]]);
//# sourceMappingURL=main.c905e1d2.chunk.js.map