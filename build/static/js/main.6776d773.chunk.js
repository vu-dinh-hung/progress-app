(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{73:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(16),c=n.n(a),s=(n(71),n(7)),o=n.n(s),i=n(10),u=n(13),l=n(64),d=n(107),b=n(112),j=n(108),p=(n(73),n(45)),h=n(103),f=n(104),m=n(105),O=n(102),x=n(28),g=n(29),v=n(60),w=n(61),y=n(66),k=n(65),C=n(111),S=n(62),D=n(2),I=function(e){Object(y.a)(n,e);var t=Object(k.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(w.a)(n,[{key:"handleClickOutside",value:function(){console.log("clicked outside"),this.props.handleCancelShowHabitForm()}},{key:"render",value:function(){var e=this.props,t=e.newHabit,n=e.setNewHabit,r=e.handleSubmitHabit;return Object(D.jsxs)("tr",{children:[Object(D.jsx)("td",{className:"align-middle text-center",children:Object(D.jsxs)(C.a,{onSubmit:r,children:[Object(D.jsx)(C.a.Group,{controlId:"formHabit",children:Object(D.jsx)(C.a.Control,{as:"input",type:"text",placeholder:"",autoComplete:"off",value:t,onChange:function(e){var t=e.target;return n(t.value)}})}),Object(D.jsx)(O.a,{variant:"secondary",type:"submit",children:"Submit"})]})}),Object(D.jsx)("td",{colSpan:"30",className:"align-middle text-secondary",children:"Type a new habit or click away to cancel"})]})}}]),n}(r.Component),H=Object(S.a)(I),M=function(e){var t=e.month,n=e.habits,r=e.logs,a=e.handleToggleCell,c=e.handleClickShowHabitForm,s=e.handleCancelShowHabitForm,o=e.handleSubmitHabit,i=e.newHabit,u=e.setNewHabit,l=e.showHabitForm,d=e.handleRemoveHabit,b=Object(h.a)(t);console.log("[Tracker] logs:",r);var j=r.reduce((function(e,t){return e.set(t.habitId,[].concat(Object(p.a)(e.get(t.habitId)||[]),[new Date(t.date).getDate()]))}),new Map);return Object(D.jsxs)(f.a,{fluid:!0,children:[Object(D.jsxs)(m.a,{bordered:!0,responsive:!0,style:{borderStyle:"hidden"},children:[Object(D.jsx)("thead",{children:Object(D.jsxs)("tr",{children:[Object(D.jsx)("th",{}),Object(p.a)(Array(31)).map((function(e,n){return n<b?Object(D.jsx)("th",{className:n+1===(new Date).getDate()&&t.getMonth()===(new Date).getMonth()?"text-center border-dark border-right-0":"text-center",children:n+1}):Object(D.jsx)("th",{className:"text-center text-light",children:n+1})}))]})}),Object(D.jsxs)("tbody",{children:[n.map((function(e){return Object(D.jsxs)("tr",{children:[Object(D.jsxs)("td",{children:[Object(D.jsx)(O.a,{variant:"sm",onClick:function(){return d(e.id)},children:Object(D.jsx)(x.a,{icon:g.e})}),e.name]}),Object(p.a)(Array(31)).map((function(t,n){return Object(D.jsx)("td",{className:"align-middle text-center",style:{padding:0,width:"3%"},children:n<b&&Object(D.jsx)(O.a,{variant:"outline-dark",size:"sm",onClick:function(){return a(n+1,e.id,j.get(e.id)&&j.get(e.id).includes(n+1))},children:Object(D.jsx)(x.a,{icon:g.a,className:j.get(e.id)&&j.get(e.id).includes(n+1)?"":"text-light"})})})}))]})})),l&&Object(D.jsx)(H,{handleCancelShowHabitForm:s,handleSubmitHabit:o,newHabit:i,setNewHabit:u})]})]}),Object(D.jsx)(O.a,{variant:"outline-secondary",size:"sm",block:!0,onClick:c,children:Object(D.jsx)(x.a,{icon:g.d})})]})},N=n(110),U=n(113),L=n(106),T=n(114),F=n(109),B=function(e){var t=e.username,n=e.setUsername,r=e.password,a=e.setPassword,c=e.handleLogin,s=Object(D.jsxs)(T.a,{id:"login-card",children:[Object(D.jsx)(T.a.Title,{as:"h3",children:"Login"}),Object(D.jsx)(T.a.Content,{children:Object(D.jsxs)(C.a,{onSubmit:c,children:[Object(D.jsxs)(C.a.Group,{controlId:"formGroupUsername",children:[Object(D.jsx)(C.a.Label,{children:"Username"}),Object(D.jsx)(C.a.Control,{type:"username",placeholder:"Enter username",value:t,autoComplete:"off",onChange:function(e){var t=e.target;return n(t.value)}})]}),Object(D.jsxs)(C.a.Group,{controlId:"formGroupPassword",children:[Object(D.jsx)(C.a.Label,{children:"Password"}),Object(D.jsx)(C.a.Control,{type:"password",placeholder:"Password",value:r,autoComplete:"off",onChange:function(e){var t=e.target;return a(t.value)}})]}),Object(D.jsx)(O.a,{variant:"primary",type:"submit",children:"Submit"})]})})]});return Object(D.jsx)(F.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:s,children:Object(D.jsx)(O.a,{variant:"outline-primary",children:"Login"})})},G=n(33),P=n.n(G),E={login:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Y=function(e){var t=e.setUser,n=e.displayMessage,a=Object(r.useState)(""),c=Object(u.a)(a,2),s=c[0],l=c[1],d=Object(r.useState)(""),b=Object(u.a)(d,2),j=b[0],p=b[1],h=Object(r.useState)(""),f=Object(u.a)(h,2),m=f[0],x=f[1],g=function(){var e=Object(i.a)(o.a.mark((function e(r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,E.register({username:s,password:j});case 4:a=e.sent,window.localStorage.setItem("progressUser",JSON.stringify(a)),t(a),n("User registered. Logged in as "+a.username),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),e.t0.response.data.error?n("Error: "+e.t0.response.data.error):n(""+e.t0);case 13:l(""),p("");case 15:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){return Object(D.jsx)("span",{style:{color:"red"},children:"*"})},w=Object(D.jsxs)(T.a,{id:"register-card",children:[Object(D.jsx)(T.a.Title,{as:"h3",children:"Register"}),Object(D.jsx)(T.a.Content,{children:Object(D.jsxs)(C.a,{onSubmit:g,children:[Object(D.jsxs)(C.a.Group,{controlId:"formGroupUsername",children:[Object(D.jsxs)(C.a.Label,{children:["Username",v()]}),Object(D.jsx)(C.a.Control,{type:"username",placeholder:"Enter username",value:s,autoComplete:"off",onChange:function(e){var t=e.target;return l(t.value)},required:!0})]}),Object(D.jsxs)(C.a.Group,{controlId:"formGroupPassword",children:[Object(D.jsxs)(C.a.Label,{children:["Password",v()]}),Object(D.jsx)(C.a.Control,{type:"password",placeholder:"Password",value:j,autoComplete:"off",onChange:function(e){var t=e.target;return p(t.value)},required:!0})]}),Object(D.jsxs)(C.a.Group,{controlId:"formGroupName",children:[Object(D.jsx)(C.a.Label,{children:"Name"}),Object(D.jsx)(C.a.Control,{type:"text",placeholder:"Your name",value:m,autoComplete:"off",onChange:function(e){var t=e.target;return x(t.value)}})]}),Object(D.jsx)(O.a,{variant:"primary",type:"submit",children:"Submit"})]})})]});return Object(D.jsx)(F.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:w,children:Object(D.jsx)(O.a,{variant:"outline-primary",children:"Register"})})},z=function(e){var t=e.user,n=e.handleLogout,r=Object(D.jsxs)(T.a,{id:"user-card",children:[Object(D.jsxs)(T.a.Title,{as:"h3",children:["Logged in as ",t.username]}),Object(D.jsx)(T.a.Content,{className:"text-center",children:Object(D.jsx)(O.a,{variant:"primary",onClick:n,children:"Logout"})})]});return Object(D.jsx)(F.a,{trigger:"click",rootClose:!0,placement:"bottom",overlay:r,children:Object(D.jsx)(O.a,{variant:"outline-primary",children:t.name?t.name:t.username})})},A=function(e){var t=e.month,n=e.onIncrementMonth,r=e.onDecrementMonth,a=e.username,c=e.password,s=e.user,o=e.setUser,i=e.setUsername,u=e.setPassword,l=e.handleLogin,d=e.handleLogout,b=e.displayMessage;return Object(D.jsx)(U.a,{bg:"light",children:Object(D.jsxs)(f.a,{children:[Object(D.jsxs)(L.a,{className:"mb-1 mx-2","aria-label":"navigate month",children:[Object(D.jsx)(O.a,{onClick:r,variant:"outline-dark",size:"sm",children:Object(D.jsx)(x.a,{className:"mt-1",icon:g.b})}),Object(D.jsx)(O.a,{onClick:n,variant:"outline-dark",size:"sm",children:Object(D.jsx)(x.a,{className:"mt-1",icon:g.c})})]}),Object(D.jsx)("span",{className:"mr-auto",children:Object(N.a)(t,"MMMM yyyy")}),s?Object(D.jsx)(z,{user:s,handleLogout:d}):Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(Y,{setUser:o,displayMessage:b}),Object(D.jsx)("span",{className:"mx-1"}),Object(D.jsx)(B,{username:a,password:c,setUsername:i,setPassword:u,handleLogin:l})]})]})})},J=n(115),R=function(e){var t=e.message;return Object(D.jsx)(J.a,{variant:t.startsWith("Error")?"danger":"info",children:t})},K=n(33),q="/api/logs",W=null,Q=null,V={setToken:function(e){W="bearer ".concat(e),Q={headers:{Authorization:W}}},get:function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.get(q,Q);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getByMonth:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.get("/api/logs?yearmonth=".concat(""+t.getFullYear()+t.getMonth()),Q);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getById:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.get("".concat(q,"/").concat(t),Q);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),post:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.post(q,t,Q);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),putById:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.put("".concat(q,"/").concat(t),n,Q);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteById:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.delete("".concat(q,"/").concat(t),Q);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},X=n(33),Z="/api/habits",$=null,_=null,ee={setToken:function(e){$="bearer ".concat(e),_={headers:{Authorization:$}}},get:function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.get(Z,_);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getById:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.get("".concat(Z,"/").concat(t),_);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),post:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.post(Z,t,_);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),putById:function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.put("".concat(Z,"/").concat(t),n,_);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteById:function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X.delete("".concat(Z,"/").concat(t),_);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},te=function(){var e=Object(r.useState)(new Date(Date.UTC((new Date).getFullYear(),(new Date).getMonth()))),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),s=Object(u.a)(c,2),p=s[0],h=s[1],f=Object(r.useState)([]),m=Object(u.a)(f,2),O=m[0],x=m[1],g=Object(r.useState)(""),v=Object(u.a)(g,2),w=v[0],y=v[1],k=Object(r.useState)(""),C=Object(u.a)(k,2),S=C[0],I=C[1],H=Object(r.useState)(null),N=Object(u.a)(H,2),U=N[0],L=N[1],T=Object(r.useState)(!1),F=Object(u.a)(T,2),B=F[0],G=F[1],P=Object(r.useState)(""),Y=Object(u.a)(P,2),z=Y[0],J=Y[1],K=Object(r.useState)(""),q=Object(u.a)(K,2),W=q[0],Q=q[1];Object(r.useEffect)((function(){var e=window.localStorage.getItem("progressUser");if(e){var t=JSON.parse(e);L(t),console.log("--first",t),V.setToken(t.token),ee.setToken(t.token)}}),[]),Object(r.useEffect)((function(){V.getByMonth(n).then((function(e){x(e)}))}),[n]),Object(r.useEffect)((function(){U?(V.setToken(U.token),ee.setToken(U.token),ee.get().then((function(e){h(e)})),a(new Date(Date.UTC((new Date).getFullYear(),(new Date).getMonth())))):(h([]),x([]))}),[U]);var X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;Q(e),setTimeout((function(){return Q("")}),t)},Z=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,E.login({username:w,password:S});case 4:n=e.sent,window.localStorage.setItem("progressUser",JSON.stringify(n)),L(n),X("Logged in as "+n.username),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),X("Error: Wrong credentials. If you don't have an account yet, please register");case 14:y(""),I("");case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),window.localStorage.removeItem("progressUser"),L(null),X("Logged out");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={id:p.length+1,name:z},e.next=4,ee.post(n);case 4:r=e.sent,h(p.concat(r)),J(""),G(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(i.a)(o.a.mark((function e(t,r,a){var c,s,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("----------------clicked cell",r,t),!a){e.next=8;break}return c=O.find((function(e){return e.habitId===r&&new Date(e.date).getDate()===t})).id,e.next=5,V.deleteById(c);case 5:x(O.filter((function(e){return!(e.habitId===r&&new Date(e.date).getDate()===t)}))),e.next=13;break;case 8:return s={habitId:r,date:new Date(Date.UTC(n.getFullYear(),n.getMonth(),t))},e.next=11,V.post(s);case 11:i=e.sent,x(O.concat(i));case 13:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),ne=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("removing",t),e.next=3,ee.deleteById(t);case 3:h(p.filter((function(e){return!(e.id===t)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(D.jsxs)("div",{children:[Object(D.jsx)(A,{month:n,onIncrementMonth:function(){return a(Object(l.a)(new Date(Date.UTC(n.getFullYear(),n.getMonth())),1))},onDecrementMonth:function(){return a(Object(d.a)(new Date(Date.UTC(n.getFullYear(),n.getMonth())),1))},username:w,password:S,user:U,setUser:L,setUsername:y,setPassword:I,handleLogin:Z,handleLogout:$,displayMessage:X}),W&&Object(D.jsx)(R,{message:W}),Object(D.jsxs)(b.a,{defaultActiveKey:"tracker",id:"tabs",children:[Object(D.jsx)(j.a,{eventKey:"tracker",title:"Tracker",className:"",children:Object(D.jsx)(M,{month:n,habits:p,logs:O,handleToggleCell:te,handleClickShowHabitForm:function(){return G(!0)},handleCancelShowHabitForm:function(){J(""),G(!1)},handleSubmitHabit:_,newHabit:z,setNewHabit:J,showHabitForm:B,handleRemoveHabit:ne})}),Object(D.jsxs)(j.a,{eventKey:"stats",title:"Stats",children:[Object(D.jsx)("br",{}),Object(D.jsx)("br",{}),Object(D.jsx)("p",{className:"text-center",children:"Coming soon~"})]})]})]})};c.a.render(Object(D.jsx)(te,{}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.6776d773.chunk.js.map